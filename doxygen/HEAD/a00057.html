<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>jrl-walkgen: PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="a00097.html">PatternGeneratorJRL</a>::<a class="el" href="a00057.html">ZMPPreviewControlWithMultiBodyZMP</a>
  </div>
</div>
<div class="contents">
<h1>PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP Class Reference<br/>
<small>
[<a class="el" href="a00100.html">JRL Walking Pattern Generator Library (WalkGenJRL)</a>]</small>
</h1><!-- doxytag: class="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP" -->
<p>Object to generate the angle positions every 5 ms from a set of absolute foot positions.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;/home/buildbot/devel-src/tools/pkg-dev-mng/Testing/Buildbot/slaves/jrlserver/jrlserverubuntu/build-jrl-walkgen-jrlmt-master/pkgsrc/src/PreviewControl/ZMPPreviewControlWithMultiBodyZMP.hh&gt;</code></p>
<div class="dynheader">
Collaboration diagram for PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP:</div>
<div class="dynsection">
<div class="center"><img src="a00268.png" border="0" usemap="#_pattern_generator_j_r_l_1_1_z_m_p_preview_control_with_multi_body_z_m_p_coll__map" alt="Collaboration graph"/></div>
<map name="_pattern_generator_j_r_l_1_1_z_m_p_preview_control_with_multi_body_z_m_p_coll__map" id="_pattern_generator_j_r_l_1_1_z_m_p_preview_control_with_multi_body_z_m_p_coll__map">
<area shape="rect" href="a00019.html" title="Structure to store the COM state computed by the preview control." alt="" coords="5,8,243,35"/><area shape="rect" doxygen="abstract-robot-dynamics.doxytag:" href="a00008.html" title="CjrlHumanoidDynamicRobot" alt="" coords="379,59,579,85"/><area shape="rect" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html" title="CjrlDynamicRobot" alt="" coords="57,59,191,85"/><area shape="rect" href="a00043.html" title="Class to implement the preview control." alt="" coords="353,109,604,136"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="a00269.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a5a2e28f46df3d35487e45725f452c67a">ZMPPreviewControlWithMultiBodyZMP</a> (SimplePluginManager *lSPM)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#af6238a18a299100243c2cd0d8882b9cf">~ZMPPreviewControlWithMultiBodyZMP</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a247666858f89d759d3dda847dce7358f">GetDifferenceBetweenComAndWaist</a> (double lComAndWaist[3])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a239a5ccf33c6e49d842eb49658613a63">OneGlobalStepOfControl</a> (<a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;LeftFootPosition, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;RightFootPosition, <a class="el" href="a00056.html">ZMPPosition</a> &amp;NewZMPRefPos, <a class="el" href="a00019.html">COMState</a> &amp;finalCOMState, MAL_VECTOR_TYPE(double)&amp;CurrentConfiguration, MAL_VECTOR_TYPE(double)&amp;CurrentVelocity, MAL_VECTOR_TYPE(double)&amp;CurrentAcceleration)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a40312a0cc836de80841d8f24e0b53511">FirstStageOfControl</a> (<a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;LeftFootPosition, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;RightFootPosition, <a class="el" href="a00019.html">COMState</a> &amp;afCOMState)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a1c760f6192da274c3ebbf133e65ff267">EvaluateMultiBodyZMP</a> (int StartingIteration)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#ac577cd8860dcd026943fc09b8f726bc1">SecondStageOfControl</a> (<a class="el" href="a00019.html">COMState</a> &amp;refandfinal)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#ab103dcd1fd21bb590e4d4b9750c8ac71">EvaluateStartingState</a> (MAL_VECTOR(&amp;, double) BodyAngles, MAL_S3_VECTOR(&amp;, double) aStartingCOMState, MAL_S3_VECTOR(&amp;, double) aStartingZMPPosition, MAL_VECTOR(&amp;, double) aStartingWaistPose, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;InitLeftFootPosition, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;InitRightFootPosition)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a8dd023c6b380a74f4f2593ef3a64d20b">EvaluateStartingCoM</a> (MAL_MATRIX(&amp;, double) BodyAngles, MAL_S3_VECTOR(&amp;, double) aStartingCOMState, MAL_VECTOR(&amp;, double) aWaistPose, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;InitLeftFootPosition, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;InitRightFootPosition)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Implementation of the GlobalStrategyManager interface.</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrp59cf986fffbc0c71d6935869dfb87201"></a> </p>
</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#ae2b0735afff92a4f6d2696c9a60e4bcf">SetStrategyForStageActivation</a> (int anAlgo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a491649445fe9bd96d75411ee57d04a97">GetStrategyForStageActivation</a> ()</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpd41d8cd98f00b204e9800998ecf8427e"></a> </p>
</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a3fe7ac32083ea8920ed154632e0b3d90">Setup</a> (deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;ZMPRefPositions, deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;COMStates, deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;LeftFootPositions, deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;RightFootPositions)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a72c62cb49381a1c1c0fb64eaf41fb2da">SetupFirstPhase</a> (deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;ZMPRefPositions, deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;COMStates, deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;LeftFootPositions, deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;RightFootPositions)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a97e74cefb7ef7cf1b2015ff39026fda1">SetupIterativePhase</a> (deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;ZMPRefPositions, deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;COMStates, deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;LeftFootPositions, deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;RightFootPositions, MAL_VECTOR_TYPE(double)&amp;CurrentConfiguration, MAL_VECTOR_TYPE(double)&amp;CurrentVelocity, MAL_VECTOR_TYPE(double)&amp;CurrentAcceleration, int localindex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#af8289f3568828873926b4a97419de444">CreateExtraCOMBuffer</a> (deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;ExtraCOMBuffer, deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;ExtraZMPBuffer, deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;ExtraZMPRefBuffer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a1c21fd0a134025a8e07f4777a3c51c80">EvaluateStartingCoM</a> (MAL_VECTOR(&amp;, double) BodyAnglesInit, MAL_S3_VECTOR(&amp;, double) aStartingCOMState, MAL_VECTOR(&amp;, double) aStartingWaistPosition, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;InitLeftFootPosition, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;InitRightFootPosition)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a0fcf21f082e6c6b6702b7cd97ef5b709">MAL_S4x4_MATRIX_TYPE</a> (double) GetFinalDesiredCOMPose()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#af0df60b6215030d801c5d9e452627d97">MAL_S4x4_MATRIX_TYPE</a> (double) GetCurrentPositionofWaistInCOMFrame()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00019.html">COMState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a4c72053a646e6fd654f875dbd596d0e1">GetLastCOMFromFirstStage</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a7e5b197ac4c193b70436eb954c2d9b5c">UpdateTheZMPRefQueue</a> (<a class="el" href="a00056.html">ZMPPosition</a> NewZMPRefPos)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Setter and getter for the ComAndZMPTrajectoryGeneration.</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpc621b677476511597283d2c36d0bfdaf"></a> </p>
</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a6197bfe007f48e16834e998bdd32e15e">setComAndFootRealization</a> (ComAndFootRealization *aCFR)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ComAndFootRealization *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a822a4ba6384b405228f2c61aeb998791">getComAndFootRealization</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a9ab3aaa0075e1b08f77f3d2cc429c590">CallToComAndFootRealization</a> (<a class="el" href="a00019.html">COMState</a> &amp;acomp, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;aLeftFAP, <a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;aRightFAP, MAL_VECTOR_TYPE(double)&amp;CurrentConfiguration, MAL_VECTOR_TYPE(double)&amp;CurrentVelocity, MAL_VECTOR_TYPE(double)&amp;CurrentAcceleration, int IterationNumber, int StageOfTheAlgorithm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#af371cdbf70d3606ad13281937127b7a6">SetPreviewControl</a> (<a class="el" href="a00043.html">PreviewControl</a> *aPC)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Setter and getter for the jrlHumanoidDynamicRobot object.</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrp8173996141e3d9599d78cfcda9c61810"></a> </p>
</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a4cd4bbdbaa4998b76d9f32bc9c00f3ca">setHumanoidDynamicRobot</a> (<a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00008.html">CjrlHumanoidDynamicRobot</a> *aHumanoidDynamicRobot)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00008.html">CjrlHumanoidDynamicRobot</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a18437c51dbe02999bdbf4fe5d59b15b9">getHumanoidDynamicRobot</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a0c214ca57df7dc84d5e11a3819f01bc8">SetStrategyForPCStages</a> (int Strategy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#ac362e97703161e019ac3f39ac91a7ce8">GetStrategyForPCStages</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a52b4b478cac84add3219a057471e04c4">CallMethod</a> (std::string &amp;Method, std::istringstream &amp;astrm)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Overloading method of SimplePlugin.  <a href="#a52b4b478cac84add3219a057471e04c4"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Public Attributes</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpd41d8cd98f00b204e9800998ecf8427e"></a> </p>
</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a7c82df9827bf790b3d1321479aa561f3">ZMPCOM_TRAJECTORY_FULL</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#a4af5774ed784ba14e812738f6d036192">ZMPCOM_TRAJECTORY_SECOND_STAGE_ONLY</a> = 2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00057.html#af9ca6bf48da956f6c0031caf6b372d4b">ZMPCOM_TRAJECTORY_FIRST_STAGE_ONLY</a> = 3</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Object to generate the angle positions every 5 ms from a set of absolute foot positions. </p>
<p>This object handles one iteration.</p>
<p>This algorithm use the preview control proposed by Kajita-San in <a class="el" href="main.html#Kajita2003">Kajita2003</a> with the two stages archictecture.</p>
<p>You therefore have to use first the Setup method to fill all the queues. Then every 5 ms just use OneGlobalStepOfControl to compute the Waist Computation position, speed, acceleration and the angular values for the left and right legs.</p>
<p>This class can also be used with Pierre-Brice Wieber algorithm's <a class="el" href="main.html#Wieber2006">Wieber2006</a> where only the second stage is used.</p>
<p>Finally in the case that the strategy adopted do not involve to compute the second stage and the first stage you can use the dummy mode. The architecture is kept the same but no computation are performed. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a5a2e28f46df3d35487e45725f452c67a"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::ZMPPreviewControlWithMultiBodyZMP" ref="a5a2e28f46df3d35487e45725f452c67a" args="(SimplePluginManager *lSPM)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZMPPreviewControlWithMultiBodyZMP::ZMPPreviewControlWithMultiBodyZMP </td>
          <td>(</td>
          <td class="paramtype">SimplePluginManager *&nbsp;</td>
          <td class="paramname"> <em>lSPM</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor. </p>

<p>References <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a600ee35ab76de8a72fbfcf6cc3542899">MAL_MATRIX_RESIZE</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00023.html#a9a4e497390e9d6fb9574e19ee76ff4e3">MAL_S4x4_MATRIX_ACCESS_I_J</a>, <a class="el" href="a00074_source.html#l00083">PatternGeneratorJRL::OptimalControllerSolver::MODE_WITHOUT_INITIALPOS</a>, and <a class="el" href="a00094_source.html#l00194">ZMPCOM_TRAJECTORY_FULL</a>.</p>

</div>
</div>
<a class="anchor" id="af6238a18a299100243c2cd0d8882b9cf"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::~ZMPPreviewControlWithMultiBodyZMP" ref="af6238a18a299100243c2cd0d8882b9cf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZMPPreviewControlWithMultiBodyZMP::~ZMPPreviewControlWithMultiBodyZMP </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destroctor. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a52b4b478cac84add3219a057471e04c4"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::CallMethod" ref="a52b4b478cac84add3219a057471e04c4" args="(std::string &amp;Method, std::istringstream &amp;astrm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZMPPreviewControlWithMultiBodyZMP::CallMethod </td>
          <td>(</td>
          <td class="paramtype">std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>Method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::istringstream &amp;&nbsp;</td>
          <td class="paramname"> <em>astrm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overloading method of SimplePlugin. </p>

</div>
</div>
<a class="anchor" id="a9ab3aaa0075e1b08f77f3d2cc429c590"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::CallToComAndFootRealization" ref="a9ab3aaa0075e1b08f77f3d2cc429c590" args="(COMState &amp;acomp, FootAbsolutePosition &amp;aLeftFAP, FootAbsolutePosition &amp;aRightFAP, MAL_VECTOR_TYPE(double)&amp;CurrentConfiguration, MAL_VECTOR_TYPE(double)&amp;CurrentVelocity, MAL_VECTOR_TYPE(double)&amp;CurrentAcceleration, int IterationNumber, int StageOfTheAlgorithm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZMPPreviewControlWithMultiBodyZMP::CallToComAndFootRealization </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00019.html">COMState</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>acomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>aLeftFAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>aRightFAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentVelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentAcceleration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>IterationNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>StageOfTheAlgorithm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Call To CoM And Foot Realization object, the last values in the stack for the CoM and the feet positions will be used. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>acomp</em>&nbsp;</td><td>: COM position, </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>aLeftFAP,:</em>&nbsp;</td><td>Pose of the left foot (3D position + 2 euler angles) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>aRightFAP,:</em>&nbsp;</td><td>Pose of the right foot (3D position + 2 euler angles) </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentConfiguration,:</em>&nbsp;</td><td>Returns the part of state vector corresponding to the position of the free floating, and the articular values. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentVelocity,:</em>&nbsp;</td><td>Returns the part of state vector corresponding to the velocity of the free floating and the articular values. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentAcceleration,:</em>&nbsp;</td><td>Returns the part of state vector corresponding to the acceleration of the free floating, and the articular values. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>IterationNumber,:</em>&nbsp;</td><td>Number of time slot realized so far. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>StageOfTheAlgorithm,:</em>&nbsp;</td><td>Indicates if this is the second stage of the preview control or the first one. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a4120f72d9000b6b3a34e207f6e90c5a6">CjrlDynamicRobot::currentAcceleration()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a93ae215b0f85036b5e09513bd209b3d1">CjrlDynamicRobot::currentConfiguration()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a5a159e2ef0e687e61b3132243146d46f">CjrlDynamicRobot::currentVelocity()</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a1a4064cac32756f5f29cb5862914b6fa">MAL_VECTOR_DIM</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a775cdf9ddf39bf63992d6d21bc980de9">MAL_VECTOR_TYPE</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::omega</a>, <a class="el" href="a00076_source.html#l00071">PatternGeneratorJRL::COMState_s::pitch</a>, <a class="el" href="a00076_source.html#l00072">PatternGeneratorJRL::COMState_s::roll</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::theta</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::x</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::x</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::y</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::y</a>, <a class="el" href="a00076_source.html#l00070">PatternGeneratorJRL::COMState_s::yaw</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::z</a>, and <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::z</a>.</p>

<p>Referenced by <a class="el" href="a00093_source.html#l00195">OneGlobalStepOfControl()</a>, and <a class="el" href="a00093_source.html#l00608">SetupIterativePhase()</a>.</p>

</div>
</div>
<a class="anchor" id="af8289f3568828873926b4a97419de444"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::CreateExtraCOMBuffer" ref="af8289f3568828873926b4a97419de444" args="(deque&lt; COMState &gt; &amp;ExtraCOMBuffer, deque&lt; ZMPPosition &gt; &amp;ExtraZMPBuffer, deque&lt; ZMPPosition &gt; &amp;ExtraZMPRefBuffer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZMPPreviewControlWithMultiBodyZMP::CreateExtraCOMBuffer </td>
          <td>(</td>
          <td class="paramtype">deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ExtraCOMBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ExtraZMPBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ExtraZMPRefBuffer</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create an extra COM buffer with a first preview round to be used by the stepover planner.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>ExtraCOMBuffer,:</em>&nbsp;</td><td>Extra FIFO for the CoM positions. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>ExtraZMPBuffer,:</em>&nbsp;</td><td>Extra FIFO for the ZMP positions (for the stepping over first preview control). </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>ExtraZMPRefBuffer,:</em>&nbsp;</td><td>Extra FIFO for the ZMP ref positions. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="a00043.html#ae3ed1b3cf686f654a17d94193a68356b">PatternGeneratorJRL::PreviewControl::OneIterationOfPreview()</a>.</p>

</div>
</div>
<a class="anchor" id="a1c760f6192da274c3ebbf133e65ff267"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::EvaluateMultiBodyZMP" ref="a1c760f6192da274c3ebbf133e65ff267" args="(int StartingIteration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::EvaluateMultiBodyZMP </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>StartingIteration</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This methods is used only to update the queue of ZMP difference for the second stage of control. Also it does not return anything this method is crucial for the overall process.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>StartingIteration,:</em>&nbsp;</td><td>-1 for the initialization, &gt;=0 for a counter which gives the time.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If an error occurs returns a negative integer, 0 otherwise. </dd></dl>

<p>References <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#aab10b113078581991fd97d4b5b25e156">CjrlDynamicRobot::computeForwardKinematics()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a93ae215b0f85036b5e09513bd209b3d1">CjrlDynamicRobot::currentConfiguration()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a22a8667e1e9a7e5308917335ca27d928">CjrlDynamicRobot::getProperty()</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a775cdf9ddf39bf63992d6d21bc980de9">MAL_VECTOR_TYPE</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a868aa196b90c2881a45dd48c9a3d2c8c">CjrlDynamicRobot::positionCenterOfMass()</a>, <a class="el" href="a00076_source.html#l00100">PatternGeneratorJRL::ZMPPosition_s::px</a>, <a class="el" href="a00076_source.html#l00100">PatternGeneratorJRL::ZMPPosition_s::py</a>, <a class="el" href="a00076_source.html#l00100">PatternGeneratorJRL::ZMPPosition_s::pz</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#aee210295ec3c0f1976a45eb8a5b39b54">CjrlDynamicRobot::setProperty()</a>, <a class="el" href="a00076_source.html#l00103">PatternGeneratorJRL::ZMPPosition_s::stepType</a>, <a class="el" href="a00076_source.html#l00101">PatternGeneratorJRL::ZMPPosition_s::theta</a>, <a class="el" href="a00076_source.html#l00102">PatternGeneratorJRL::ZMPPosition_s::time</a>, and <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00008.html#a338d0629912bee27134751ba657dce83">CjrlHumanoidDynamicRobot::zeroMomentumPoint()</a>.</p>

<p>Referenced by <a class="el" href="a00093_source.html#l00195">OneGlobalStepOfControl()</a>, and <a class="el" href="a00093_source.html#l00608">SetupIterativePhase()</a>.</p>

</div>
</div>
<a class="anchor" id="a1c21fd0a134025a8e07f4777a3c51c80"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::EvaluateStartingCoM" ref="a1c21fd0a134025a8e07f4777a3c51c80" args="(MAL_VECTOR(&amp;, double) BodyAnglesInit, MAL_S3_VECTOR(&amp;, double) aStartingCOMState, MAL_VECTOR(&amp;, double) aStartingWaistPosition, FootAbsolutePosition &amp;InitLeftFootPosition, FootAbsolutePosition &amp;InitRightFootPosition)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::EvaluateStartingCoM </td>
          <td>(</td>
          <td class="paramtype">MAL_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>BodyAnglesInit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_S3_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>aStartingCOMState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>aStartingWaistPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>InitLeftFootPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>InitRightFootPosition</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluate Starting CoM for a given position. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>BodyAnglesInit,:</em>&nbsp;</td><td>The state vector used to compute the CoM. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>aStartingCOMState,:</em>&nbsp;</td><td>The CoM of the position specified. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>InitLeftFootPosition,:</em>&nbsp;</td><td>Position of the InitLeftFootPosition in the same reference frame than the waist. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>InitRightFootPosition,:</em>&nbsp;</td><td>Position of the InitRightFootPosition in the same reference frame than the waist </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8dd023c6b380a74f4f2593ef3a64d20b"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::EvaluateStartingCoM" ref="a8dd023c6b380a74f4f2593ef3a64d20b" args="(MAL_MATRIX(&amp;, double) BodyAngles, MAL_S3_VECTOR(&amp;, double) aStartingCOMState, MAL_VECTOR(&amp;, double) aWaistPose, FootAbsolutePosition &amp;InitLeftFootPosition, FootAbsolutePosition &amp;InitRightFootPosition)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::EvaluateStartingCoM </td>
          <td>(</td>
          <td class="paramtype">MAL_MATRIX(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>BodyAngles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_S3_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>aStartingCOMState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>aWaistPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>InitLeftFootPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>InitRightFootPosition</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute the COM of the robot with the Joint values given in BodyAngles, velocities set to zero, and returns the values of the COM in aStaringCOMState. Assuming that the waist is at (0,0,0) it returns the associate initial values for the left and right foot. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BodyAngles,:</em>&nbsp;</td><td>Vector of the joint values for the robot. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>aStartingCOMState,:</em>&nbsp;</td><td>Position of the CoM. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>aWaistPosition,:</em>&nbsp;</td><td>Position of the Waist. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>InitLeftFootPosition,:</em>&nbsp;</td><td>Position of the left foot in the waist coordinates frame. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>InitRightFootPosition,:</em>&nbsp;</td><td>Position of the right foot in the waist coordinates frame. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab103dcd1fd21bb590e4d4b9750c8ac71"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::EvaluateStartingState" ref="ab103dcd1fd21bb590e4d4b9750c8ac71" args="(MAL_VECTOR(&amp;, double) BodyAngles, MAL_S3_VECTOR(&amp;, double) aStartingCOMState, MAL_S3_VECTOR(&amp;, double) aStartingZMPPosition, MAL_VECTOR(&amp;, double) aStartingWaistPose, FootAbsolutePosition &amp;InitLeftFootPosition, FootAbsolutePosition &amp;InitRightFootPosition)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::EvaluateStartingState </td>
          <td>(</td>
          <td class="paramtype">MAL_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>BodyAngles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_S3_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>aStartingCOMState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_S3_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>aStartingZMPPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR(&amp;, double)&nbsp;</td>
          <td class="paramname"> <em>aStartingWaistPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>InitLeftFootPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>InitRightFootPosition</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute the COM of the robot with the Joint values given in BodyAngles, velocities set to zero, and returns the values of the COM in aStaringCOMState. Assuming that the waist is at (0,0,0) it returns the associate initial values for the left and right foot. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>BodyAngles,:</em>&nbsp;</td><td>4x4 matrix of the robot's root (most of the time, the waist) pose (position + orientation). </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>aStartingCOMState,:</em>&nbsp;</td><td>Returns the 3D position of the CoM for the current position of the robot. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>aStartingZMPPosition,:</em>&nbsp;</td><td>Returns the 3D position of the ZMP for the current position of the robot. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>InitLeftFootPosition,:</em>&nbsp;</td><td>Returns the position of the left foot in the waist coordinates frame. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>InitRightFootPosition,:</em>&nbsp;</td><td>Returns the position of the right foot in the waist coordinates frame. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a40312a0cc836de80841d8f24e0b53511"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::FirstStageOfControl" ref="a40312a0cc836de80841d8f24e0b53511" args="(FootAbsolutePosition &amp;LeftFootPosition, FootAbsolutePosition &amp;RightFootPosition, COMState &amp;afCOMState)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::FirstStageOfControl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>LeftFootPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>RightFootPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00019.html">COMState</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>afCOMState</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>First stage of the control, i.e.preview control on the CART model with delayed step parameters, Inverse Kinematics, and ZMP calculated with the multi body model. aCOMState will be updated with the new value of the COM computed by the card model. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>LeftFootPosition,:</em>&nbsp;</td><td>The position of the k+NL Left Foot position. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>RightFootPosition,:</em>&nbsp;</td><td>The position of the k+NL Right Foot position. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>afCOMState,:</em>&nbsp;</td><td>A COM position of reference, in this context, this will be the height of the waist.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If an error occurs returns a negative integer, 0 otherwise. </dd></dl>

<p>References <a class="el" href="a00043.html#ae3ed1b3cf686f654a17d94193a68356b">PatternGeneratorJRL::PreviewControl::OneIterationOfPreview()</a>, <a class="el" href="a00076_source.html#l00071">PatternGeneratorJRL::COMState_s::pitch</a>, <a class="el" href="a00076_source.html#l00072">PatternGeneratorJRL::COMState_s::roll</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::x</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::y</a>, <a class="el" href="a00076_source.html#l00070">PatternGeneratorJRL::COMState_s::yaw</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::z</a>, <a class="el" href="a00094_source.html#l00200">ZMPCOM_TRAJECTORY_FIRST_STAGE_ONLY</a>, <a class="el" href="a00094_source.html#l00194">ZMPCOM_TRAJECTORY_FULL</a>, and <a class="el" href="a00094_source.html#l00197">ZMPCOM_TRAJECTORY_SECOND_STAGE_ONLY</a>.</p>

<p>Referenced by <a class="el" href="a00093_source.html#l00195">OneGlobalStepOfControl()</a>, and <a class="el" href="a00093_source.html#l00608">SetupIterativePhase()</a>.</p>

</div>
</div>
<a class="anchor" id="a822a4ba6384b405228f2c61aeb998791"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::getComAndFootRealization" ref="a822a4ba6384b405228f2c61aeb998791" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ComAndFootRealization* PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::getComAndFootRealization </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a247666858f89d759d3dda847dce7358f"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::GetDifferenceBetweenComAndWaist" ref="a247666858f89d759d3dda847dce7358f" args="(double lComAndWaist[3])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::GetDifferenceBetweenComAndWaist </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>lComAndWaist</em>[3]</td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the difference between the Waist and the CoM for a starting position. </p>

</div>
</div>
<a class="anchor" id="a18437c51dbe02999bdbf4fe5d59b15b9"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::getHumanoidDynamicRobot" ref="a18437c51dbe02999bdbf4fe5d59b15b9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00008.html">CjrlHumanoidDynamicRobot</a>* PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::getHumanoidDynamicRobot </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the object able to compute the dynamic parameters of the robot. </p>

</div>
</div>
<a class="anchor" id="a4c72053a646e6fd654f875dbd596d0e1"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::GetLastCOMFromFirstStage" ref="a4c72053a646e6fd654f875dbd596d0e1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00019.html">COMState</a> ZMPPreviewControlWithMultiBodyZMP::GetLastCOMFromFirstStage </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the last element of the COM FIFO in the first stage of control </p>

</div>
</div>
<a class="anchor" id="ac362e97703161e019ac3f39ac91a7ce8"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::GetStrategyForPCStages" ref="ac362e97703161e019ac3f39ac91a7ce8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::GetStrategyForPCStages </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the strategy to handle the preview control stages. </p>

</div>
</div>
<a class="anchor" id="a491649445fe9bd96d75411ee57d04a97"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::GetStrategyForStageActivation" ref="a491649445fe9bd96d75411ee57d04a97" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::GetStrategyForStageActivation </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the strategy for the activation of the stage. </p>

</div>
</div>
<a class="anchor" id="af0df60b6215030d801c5d9e452627d97"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::MAL_S4x4_MATRIX_TYPE" ref="af0df60b6215030d801c5d9e452627d97" args="(double) GetCurrentPositionofWaistInCOMFrame()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::MAL_S4x4_MATRIX_TYPE </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method returns the current waist position in the COM reference frame. This can be used with the previous method to get the final Waist position. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A 4x4 matrix of double which includes the desired final Waist in the CoM phase position and orientation. </dd></dl>

</div>
</div>
<a class="anchor" id="a0fcf21f082e6c6b6702b7cd97ef5b709"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::MAL_S4x4_MATRIX_TYPE" ref="a0fcf21f082e6c6b6702b7cd97ef5b709" args="(double) GetFinalDesiredCOMPose()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::MAL_S4x4_MATRIX_TYPE </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method returns the final COM pose matrix after the second stage of control. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A 4x4 matrix of double which includes the desired final CoM position and orientation. </dd></dl>

</div>
</div>
<a class="anchor" id="a239a5ccf33c6e49d842eb49658613a63"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::OneGlobalStepOfControl" ref="a239a5ccf33c6e49d842eb49658613a63" args="(FootAbsolutePosition &amp;LeftFootPosition, FootAbsolutePosition &amp;RightFootPosition, ZMPPosition &amp;NewZMPRefPos, COMState &amp;finalCOMState, MAL_VECTOR_TYPE(double)&amp;CurrentConfiguration, MAL_VECTOR_TYPE(double)&amp;CurrentVelocity, MAL_VECTOR_TYPE(double)&amp;CurrentAcceleration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::OneGlobalStepOfControl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>LeftFootPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html">FootAbsolutePosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>RightFootPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00056.html">ZMPPosition</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>NewZMPRefPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00019.html">COMState</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>finalCOMState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentVelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentAcceleration</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform a 5 ms step to generate the full set of angular positions. The main point of the preview control is to use the future to compute the current state needed for the robot. Therefore knowing that the future window needed is of size NL=SamplingPeriod * PreviewControlWindow, and that the algorithm is a two stages preview control, the foot position needs to be provided at k+NL, and the ZMP references at k+2*NL.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>LeftFootPosition,:</em>&nbsp;</td><td>The position of the k+NL Left Foot position. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>RightFootPosition,:</em>&nbsp;</td><td>The position of the k+NL Right Foot position. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>NewZMPRefPos,:</em>&nbsp;</td><td>The ZMP position at k + 2*NL. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>finalCOMState,:</em>&nbsp;</td><td>returns position, velocity and acceleration of the CoM after the second stage of control, i.e. the final value. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentConfiguration,:</em>&nbsp;</td><td>The results is a state vector containing the articular positions. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentVelocity,:</em>&nbsp;</td><td>The results is a state vector containing the speed. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentAcceleration,:</em>&nbsp;</td><td>The results is a state vector containing the acceleration. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="a00087_source.html#l00388">c</a>, <a class="el" href="a00093_source.html#l00110">CallToComAndFootRealization()</a>, <a class="el" href="a00093_source.html#l00445">EvaluateMultiBodyZMP()</a>, <a class="el" href="a00093_source.html#l00375">FirstStageOfControl()</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00023.html#a9a4e497390e9d6fb9574e19ee76ff4e3">MAL_S4x4_MATRIX_ACCESS_I_J</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a775cdf9ddf39bf63992d6d21bc980de9">MAL_VECTOR_TYPE</a>, <a class="el" href="a00093_source.html#l00314">SecondStageOfControl()</a>, <a class="el" href="a00076_source.html#l00124">PatternGeneratorJRL::FootAbsolutePosition_t::stepType</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::x</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::x</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::y</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::y</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::z</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::z</a>, and <a class="el" href="a00094_source.html#l00200">ZMPCOM_TRAJECTORY_FIRST_STAGE_ONLY</a>.</p>

</div>
</div>
<a class="anchor" id="ac577cd8860dcd026943fc09b8f726bc1"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::SecondStageOfControl" ref="ac577cd8860dcd026943fc09b8f726bc1" args="(COMState &amp;refandfinal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::SecondStageOfControl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00019.html">COMState</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>refandfinal</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Second stage of the control, i.e. preview control on the Delta ZMP. COM correction, and computation of the final robot state (only the left and right legs).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>refandfinal,:</em>&nbsp;</td><td>The final position of the CoM. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If an error occurs returns a negative integer, 0 otherwise. </dd></dl>

<p>References <a class="el" href="a00043.html#ae3ed1b3cf686f654a17d94193a68356b">PatternGeneratorJRL::PreviewControl::OneIterationOfPreview()</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::x</a>, <a class="el" href="a00076_source.html#l00069">PatternGeneratorJRL::COMState_s::y</a>, <a class="el" href="a00094_source.html#l00194">ZMPCOM_TRAJECTORY_FULL</a>, and <a class="el" href="a00094_source.html#l00197">ZMPCOM_TRAJECTORY_SECOND_STAGE_ONLY</a>.</p>

<p>Referenced by <a class="el" href="a00093_source.html#l00195">OneGlobalStepOfControl()</a>.</p>

</div>
</div>
<a class="anchor" id="a6197bfe007f48e16834e998bdd32e15e"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::setComAndFootRealization" ref="a6197bfe007f48e16834e998bdd32e15e" args="(ComAndFootRealization *aCFR)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::setComAndFootRealization </td>
          <td>(</td>
          <td class="paramtype">ComAndFootRealization *&nbsp;</td>
          <td class="paramname"> <em>aCFR</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4cd4bbdbaa4998b76d9f32bc9c00f3ca"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::setHumanoidDynamicRobot" ref="a4cd4bbdbaa4998b76d9f32bc9c00f3ca" args="(CjrlHumanoidDynamicRobot *aHumanoidDynamicRobot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::setHumanoidDynamicRobot </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00008.html">CjrlHumanoidDynamicRobot</a> *&nbsp;</td>
          <td class="paramname"> <em>aHumanoidDynamicRobot</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>aHumanoidDynamicRobot,:</em>&nbsp;</td><td>an object able to compute dynamic parameters of the robot. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af371cdbf70d3606ad13281937127b7a6"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::SetPreviewControl" ref="af371cdbf70d3606ad13281937127b7a6" args="(PreviewControl *aPC)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZMPPreviewControlWithMultiBodyZMP::SetPreviewControl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00043.html">PreviewControl</a> *&nbsp;</td>
          <td class="paramname"> <em>aPC</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the link to the preview control. </p>

<p>References <a class="el" href="a00043.html#a8fa985e9a7ec165efed5c5ce0c9a403b">PatternGeneratorJRL::PreviewControl::PreviewControlTime()</a>, and <a class="el" href="a00043.html#aa178004c3f8f46389a5b61b2b66c0a1f">PatternGeneratorJRL::PreviewControl::SamplingPeriod()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c214ca57df7dc84d5e11a3819f01bc8"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::SetStrategyForPCStages" ref="a0c214ca57df7dc84d5e11a3819f01bc8" args="(int Strategy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZMPPreviewControlWithMultiBodyZMP::SetStrategyForPCStages </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Strategy</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the strategy to handle the preview control stages. </p>

</div>
</div>
<a class="anchor" id="ae2b0735afff92a4f6d2696c9a60e4bcf"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::SetStrategyForStageActivation" ref="ae2b0735afff92a4f6d2696c9a60e4bcf" args="(int anAlgo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZMPPreviewControlWithMultiBodyZMP::SetStrategyForStageActivation </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>anAlgo</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the algorithm used for ZMP and CoM trajectory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>anAlgo,:</em>&nbsp;</td><td>The algorithm to be used for ZMP and CoM trajectory generation. They are 3 possible values:</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>ZMPCOM_TRAJECTORY_FULL: Two preview control are computed. The first to generate a CoM trajectory based on the cart model. The second to correct this trajectory using the multibody ZMP.</li>
</ul>
<ul>
<li>ZMPCOM_TRAJECTORY_SECOND_STAGE_ONLY: Only the second stage is used. The first CoM trajectory is used by a different process. This allow to mix different algorithms (notable the quadratic problem with constraints).</li>
</ul>
<ul>
<li>ZMPCOM_TRAJECTORY_FIRST_STAGE_ONLY: Use only the first stage to generate the CoM trajectory. It is strongly adviced in this case, to not use the geometrical ZMP and CoM trajectory generation but an external CoM task.</li>
</ul>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns false if this is not possible. </dd></dl>

<p>References <a class="el" href="a00094_source.html#l00200">ZMPCOM_TRAJECTORY_FIRST_STAGE_ONLY</a>, <a class="el" href="a00094_source.html#l00194">ZMPCOM_TRAJECTORY_FULL</a>, and <a class="el" href="a00094_source.html#l00197">ZMPCOM_TRAJECTORY_SECOND_STAGE_ONLY</a>.</p>

</div>
</div>
<a class="anchor" id="a3fe7ac32083ea8920ed154632e0b3d90"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::Setup" ref="a3fe7ac32083ea8920ed154632e0b3d90" args="(deque&lt; ZMPPosition &gt; &amp;ZMPRefPositions, deque&lt; COMState &gt; &amp;COMStates, deque&lt; FootAbsolutePosition &gt; &amp;LeftFootPositions, deque&lt; FootAbsolutePosition &gt; &amp;RightFootPositions)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::Setup </td>
          <td>(</td>
          <td class="paramtype">deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ZMPRefPositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>COMStates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>LeftFootPositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>RightFootPositions</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Methods related to the preparation of the ZMP preview control with Multibody ZMP compensation.</p>
<p>Setup (Frontal Global), compute internally all the steps to get NL ZMP multibody values.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ZMPRefPositions,:</em>&nbsp;</td><td>FIFO of the ZMP reference values. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>COMStates,:</em>&nbsp;</td><td>FIFO of the COM reference positions (here only the height position is taken into account). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>LeftFootPositions,:</em>&nbsp;</td><td>FIFO of the left foot positions computed by ZMPDiscretization (the object creating the ZMP and foot reference trajectories). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>RightFootPositions,:</em>&nbsp;</td><td>idem than the previous one but for the right foot. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="a00043.html#aa0f8b67641632af4856e27a5949271a6">PatternGeneratorJRL::PreviewControl::ComputeOptimalWeights()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a4120f72d9000b6b3a34e207f6e90c5a6">CjrlDynamicRobot::currentAcceleration()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a93ae215b0f85036b5e09513bd209b3d1">CjrlDynamicRobot::currentConfiguration()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a5a159e2ef0e687e61b3132243146d46f">CjrlDynamicRobot::currentVelocity()</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a775cdf9ddf39bf63992d6d21bc980de9">MAL_VECTOR_TYPE</a>, <a class="el" href="a00074_source.html#l00083">PatternGeneratorJRL::OptimalControllerSolver::MODE_WITHOUT_INITIALPOS</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#aee210295ec3c0f1976a45eb8a5b39b54">CjrlDynamicRobot::setProperty()</a>, <a class="el" href="a00093_source.html#l00528">SetupFirstPhase()</a>, and <a class="el" href="a00093_source.html#l00608">SetupIterativePhase()</a>.</p>

</div>
</div>
<a class="anchor" id="a72c62cb49381a1c1c0fb64eaf41fb2da"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::SetupFirstPhase" ref="a72c62cb49381a1c1c0fb64eaf41fb2da" args="(deque&lt; ZMPPosition &gt; &amp;ZMPRefPositions, deque&lt; COMState &gt; &amp;COMStates, deque&lt; FootAbsolutePosition &gt; &amp;LeftFootPositions, deque&lt; FootAbsolutePosition &gt; &amp;RightFootPositions)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::SetupFirstPhase </td>
          <td>(</td>
          <td class="paramtype">deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ZMPRefPositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>COMStates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>LeftFootPositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>RightFootPositions</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Method to perform the First Phase. It initializes properly the internal fields of <a class="el" href="a00057.html" title="Object to generate the angle positions every 5 ms from a set of absolute foot positions...">ZMPPreviewControlWithMultiBodyZMP</a> for the setup phase.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ZMPRefPositions,:</em>&nbsp;</td><td>FIFO of the ZMP reference values. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>COMStates,:</em>&nbsp;</td><td>FIFO of the COM reference positions (here only the height position is taken into account). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>LeftFootPositions,:</em>&nbsp;</td><td>FIFO of the left foot positions computed by ZMPDiscretization (the object creating the ZMP and foot reference trajectories). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>RightFootPositions,:</em>&nbsp;</td><td>idem than the previous one but for the right foot. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a4120f72d9000b6b3a34e207f6e90c5a6">CjrlDynamicRobot::currentAcceleration()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a93ae215b0f85036b5e09513bd209b3d1">CjrlDynamicRobot::currentConfiguration()</a>, <a class="elRef" doxygen="abstract-robot-dynamics.doxytag:" href="a00005.html#a5a159e2ef0e687e61b3132243146d46f">CjrlDynamicRobot::currentVelocity()</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a9b344bd5bde26de522800e2ee2b9ce9f">MAL_VECTOR</a>, and <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a3c6dd8cbee88b2fc347b8b6c2298ef9c">MAL_VECTOR_SIZE</a>.</p>

<p>Referenced by <a class="el" href="a00093_source.html#l00488">Setup()</a>.</p>

</div>
</div>
<a class="anchor" id="a97e74cefb7ef7cf1b2015ff39026fda1"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::SetupIterativePhase" ref="a97e74cefb7ef7cf1b2015ff39026fda1" args="(deque&lt; ZMPPosition &gt; &amp;ZMPRefPositions, deque&lt; COMState &gt; &amp;COMStates, deque&lt; FootAbsolutePosition &gt; &amp;LeftFootPositions, deque&lt; FootAbsolutePosition &gt; &amp;RightFootPositions, MAL_VECTOR_TYPE(double)&amp;CurrentConfiguration, MAL_VECTOR_TYPE(double)&amp;CurrentVelocity, MAL_VECTOR_TYPE(double)&amp;CurrentAcceleration, int localindex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ZMPPreviewControlWithMultiBodyZMP::SetupIterativePhase </td>
          <td>(</td>
          <td class="paramtype">deque&lt; <a class="el" href="a00056.html">ZMPPosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ZMPRefPositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00019.html">COMState</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>COMStates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>LeftFootPositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">deque&lt; <a class="el" href="a00021.html">FootAbsolutePosition</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>RightFootPositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentVelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MAL_VECTOR_TYPE(double)&amp;&nbsp;</td>
          <td class="paramname"> <em>CurrentAcceleration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>localindex</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Method to call while feeding the 2 preview windows. It updates the first values of the Preview control This structure is needed if it is needed to modify BodyAngles according to the value of the COM.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ZMPRefPositions,:</em>&nbsp;</td><td>FIFO of the ZMP reference values. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>COMStates,:</em>&nbsp;</td><td>FIFO of the COM reference positions (here only the height position is taken into account). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>LeftFootPositions,:</em>&nbsp;</td><td>FIFO of the left foot positions computed by ZMPDiscretization (the object creating the ZMP and foot reference trajectories). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>RightFootPositions,:</em>&nbsp;</td><td>idem than the previous one but for the right foot. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentConfiguration,:</em>&nbsp;</td><td>The position part of the state vector realizing the current CoM and feet position instance. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentVelocity,:</em>&nbsp;</td><td>The velocity part of the state vector realizing the current CoM and feet position instance. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>CurrentAcceleration,:</em>&nbsp;</td><td>The acceleration part of the state vector realizing the current CoM and feet position instance. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>localindex,:</em>&nbsp;</td><td>Value of the index which goes from 0 to 2 * m_NL. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="a00093_source.html#l00110">CallToComAndFootRealization()</a>, <a class="el" href="a00093_source.html#l00445">EvaluateMultiBodyZMP()</a>, <a class="el" href="a00093_source.html#l00375">FirstStageOfControl()</a>, <a class="elRef" doxygen="jrl-mal.doxytag:" href="a00019.html#a775cdf9ddf39bf63992d6d21bc980de9">MAL_VECTOR_TYPE</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::x</a>, <a class="el" href="a00087_source.html#l00388">x</a>, <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::y</a>, and <a class="el" href="a00076_source.html#l00115">PatternGeneratorJRL::FootAbsolutePosition_t::z</a>.</p>

<p>Referenced by <a class="el" href="a00093_source.html#l00488">Setup()</a>.</p>

</div>
</div>
<a class="anchor" id="a7e5b197ac4c193b70436eb954c2d9b5c"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::UpdateTheZMPRefQueue" ref="a7e5b197ac4c193b70436eb954c2d9b5c" args="(ZMPPosition NewZMPRefPos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZMPPreviewControlWithMultiBodyZMP::UpdateTheZMPRefQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00056.html">ZMPPosition</a>&nbsp;</td>
          <td class="paramname"> <em>NewZMPRefPos</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Update the queue of ZMP reference value. </p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="af9ca6bf48da956f6c0031caf6b372d4b"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::ZMPCOM_TRAJECTORY_FIRST_STAGE_ONLY" ref="af9ca6bf48da956f6c0031caf6b372d4b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="a00057.html#af9ca6bf48da956f6c0031caf6b372d4b">PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::ZMPCOM_TRAJECTORY_FIRST_STAGE_ONLY</a> = 3<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constant to compute only the first stage. </p>

<p>Referenced by <a class="el" href="a00093_source.html#l00375">FirstStageOfControl()</a>, <a class="el" href="a00093_source.html#l00195">OneGlobalStepOfControl()</a>, and <a class="el" href="a00093_source.html#l00755">SetStrategyForStageActivation()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c82df9827bf790b3d1321479aa561f3"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::ZMPCOM_TRAJECTORY_FULL" ref="a7c82df9827bf790b3d1321479aa561f3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="a00057.html#a7c82df9827bf790b3d1321479aa561f3">PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::ZMPCOM_TRAJECTORY_FULL</a> = 1<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constantes to define the strategy with the first and second stage.</p>
<p>Constant to compute the first and second stage. </p>

<p>Referenced by <a class="el" href="a00093_source.html#l00375">FirstStageOfControl()</a>, <a class="el" href="a00093_source.html#l00314">SecondStageOfControl()</a>, <a class="el" href="a00093_source.html#l00755">SetStrategyForStageActivation()</a>, and <a class="el" href="a00093_source.html#l00046">ZMPPreviewControlWithMultiBodyZMP()</a>.</p>

</div>
</div>
<a class="anchor" id="a4af5774ed784ba14e812738f6d036192"></a><!-- doxytag: member="PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::ZMPCOM_TRAJECTORY_SECOND_STAGE_ONLY" ref="a4af5774ed784ba14e812738f6d036192" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="a00057.html#a4af5774ed784ba14e812738f6d036192">PatternGeneratorJRL::ZMPPreviewControlWithMultiBodyZMP::ZMPCOM_TRAJECTORY_SECOND_STAGE_ONLY</a> = 2<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constant to compute only the second stage </p>

<p>Referenced by <a class="el" href="a00093_source.html#l00375">FirstStageOfControl()</a>, <a class="el" href="a00093_source.html#l00314">SecondStageOfControl()</a>, and <a class="el" href="a00093_source.html#l00755">SetStrategyForStageActivation()</a>.</p>

</div>
</div>
</div>
</body>
</html>
