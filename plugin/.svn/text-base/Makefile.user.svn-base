user_all: user_targets 
include Makefile

USER_PLUGINS = 	$(IOSRVBIN)/WalkGenJRL.$(DLLSFX) 
		

USER_OBJS    = 	$(IOSRVBIN)/WalkGenJRL.$(OSFX)\
	     	$(IOSRVBIN)/walkpluginJRL_skel.$(OSFX) \
	     	$(IOSRVBIN)/walkpluginJRL.$(OSFX)
	     
		
user_targets:make_stubskel $(USER_PLUGINS)

PATTERNGENERATORJRLDIR=$(OPENHRPHOME)/PatternGeneratorJRL/trunk/PatternGeneratorJRL/

$(USER_PLUGINS):
	$(LINK) $(SOFLAGS) $(OUTOPT)$@ $^
$(USER_OBJS):
	$(CXX) $(CFLAGS) -I../../robot/$(ROBOT) $< -o $@
make_stubskel:
	cd $(CONTROLLER)/$(CORBA_DIR);make

CXX_FLAGS+=-I$(PATTERNGENERATORJRLDIR)/include -I$(PATTERNGENERATORJRLDIR)/plugin/corba/ORBIX/cpp
LINK_FLAGS+=-L$(PATTERNGENERATORJRLDIR)/lib -lWalkGenJRL -lVNL -lVNL -lpthread -lf2c


COMMON_TARGET_H= plugin.h $(CONTROLLER)/$(CORBA_DIR)/common.h
$(IOSRVBIN)/WalkGenJRL.$(DLLSFX): $(IOSRVBIN)/WalkGenJRL.$(OSFX) seqplugin.$(OSFX) dynamicsPlugin.$(OSFX)  $(IOSRVBIN)/walkpluginJRL_skel.$(OSFX) $(IOSRVBIN)/walkpluginJRL.$(OSFX)

$(IOSRVBIN)/WalkGenJRL.$(OSFX): $(SOURCE_DIR)/WalkGenJRL.cpp $(COMMON_TARGET_H) seqplugin.h dynamicsPlugin.h
$(IOSRVBIN)/walkpluginJRL_skel.$(OSFX):$(SOURCE_DIR)/corba/ORBIX/cpp/walkpluginJRL_skel.cpp common.h 
$(IOSRVBIN)/walkpluginJRL.$(OSFX):$(SOURCE_DIR)/corba/ORBIX/cpp/walkpluginJRL.cpp common.h 


user_clean:
	rm -f $(USER_PLUGINS) $(USER_OBJS)
	rm -f common.h 
	rm -f $(PATTERNGENERATORJRLDIR)/plugin/*~

$(IOSRVBIN)/script/TestWalkJRLIntegrateExperiment2.py:
	ln -s $(SOURCE_DIR)/TestWalkJRLIntegrateExperiment.py $(IOSRVBIN)/script/TestWalkJRLIntegrateExperiment2.py

user_install:$(IOSRVBIN)/script/TestWalkJRLIntegrateExperiment2.py
